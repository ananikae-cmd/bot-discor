const express = require("express");
const app = express();

app.get("/", (req, res) => {
  res.send("Bot activo y funcionando âœ…");
});

app.listen(3000, () => {
  console.log("Servidor web encendido en puerto 3000");
});

const { Client, GatewayIntentBits, Partials } = require("discord.js");

const client = new Client({
  intents: [
    GatewayIntentBits.Guilds,
    GatewayIntentBits.GuildMessages,
    GatewayIntentBits.MessageContent,
  ],
  partials: [Partials.Message, Partials.Channel, Partials.Reaction],
});

// âš ï¸ Cambia esto por el ID del canal de logs
const LOG_CHANNEL_ID = "1449769436969046137";

// Usamos clientReady en vez de ready (para evitar la advertencia)
client.once("clientReady", () => {
  console.log(`âœ… Bot conectado como ${client.user.tag}`);
});

// ğŸ—‘ï¸ Mensajes eliminados
client.on("messageDelete", (message) => {
  const logChannel = message.guild.channels.cache.get(LOG_CHANNEL_ID);
  if (logChannel) {
    logChannel.send(
      `ğŸ—‘ï¸ Mensaje eliminado en #${message.channel?.name} por ${
        message.author?.tag || "desconocido"
      }:\n${message.content || "(sin contenido)"}`
    );
  }
});

// âœï¸ Mensajes editados
client.on("messageUpdate", (oldMessage, newMessage) => {
  if (oldMessage.content === newMessage.content) return;
  const logChannel = newMessage.guild.channels.cache.get(LOG_CHANNEL_ID);
  if (logChannel) {
    logChannel.send(
      `âœï¸ Mensaje editado en #${newMessage.channel?.name} por ${
        newMessage.author?.tag || "desconocido"
      }:\nAntes: ${oldMessage.content || "(sin contenido)"}\nDespuÃ©s: ${
        newMessage.content || "(sin contenido)"
      }`
    );
  }
});

client.login(
  "TOKEN"
);
